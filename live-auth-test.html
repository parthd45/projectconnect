<!DOCTYPE html>
<html>
<head>
    <title>🧪 Live Authentication Testing Suite</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }
        .test-section { 
            margin: 25px 0; 
            padding: 20px; 
            border: 2px solid rgba(255,255,255,0.2); 
            border-radius: 15px; 
            background: rgba(255,255,255,0.05);
        }
        .success { color: #4ade80; font-weight: bold; }
        .error { color: #f87171; font-weight: bold; }
        .warning { color: #fbbf24; font-weight: bold; }
        .info { color: #60a5fa; font-weight: bold; }
        button { 
            margin: 8px; 
            padding: 12px 20px; 
            border: none;
            border-radius: 8px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s;
        }
        button:hover { transform: translateY(-2px); }
        input { 
            margin: 8px; 
            padding: 12px; 
            width: 250px; 
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 14px;
        }
        input::placeholder { color: rgba(255,255,255,0.7); }
        .result { 
            margin-top: 15px; 
            padding: 15px; 
            background: rgba(0,0,0,0.3); 
            border-radius: 10px; 
            border-left: 4px solid #60a5fa;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .status-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid rgba(255,255,255,0.2);
        }
        h1 { text-align: center; margin-bottom: 30px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        h2 { color: #fbbf24; margin-bottom: 15px; }
        .dashboard-test { 
            background: linear-gradient(45deg, #10b981, #059669); 
            border: none;
            padding: 15px 25px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧪 ProjectConnect Live Authentication Testing</h1>
        <p style="text-align: center; font-size: 18px; margin-bottom: 30px;">
            Testing: <strong>https://projectconnect.tech</strong> | Backend: <strong>Vercel</strong>
        </p>
        
        <!-- Status Dashboard -->
        <div class="status-grid">
            <div class="status-card">
                <h3>🔄 Test Status</h3>
                <div id="overall-status">Ready to test...</div>
            </div>
            <div class="status-card">
                <h3>📊 Results Summary</h3>
                <div id="results-summary">0/0 tests completed</div>
            </div>
        </div>

        <!-- User Registration Test -->
        <div class="test-section">
            <h2>1. 📝 User Registration Test</h2>
            <p>Test creating a new account and automatic dashboard redirect</p>
            <input type="text" id="reg-name" placeholder="Full Name" value="Test User Live">
            <input type="email" id="reg-email" placeholder="Email (auto-generated)" value="">
            <input type="password" id="reg-password" placeholder="Password" value="TestPass123!">
            <br>
            <button onclick="testRegistration()">🚀 Test Signup & Dashboard Redirect</button>
            <div id="registration-result" class="result"></div>
        </div>

        <!-- User Login Test -->
        <div class="test-section">
            <h2>2. 🔐 User Login Test</h2>
            <p>Test signing in with existing account and dashboard redirect</p>
            <input type="email" id="login-email" placeholder="Email (from signup)" value="">
            <input type="password" id="login-password" placeholder="Password" value="TestPass123!">
            <br>
            <button onclick="testLogin()">🔑 Test Login & Dashboard Redirect</button>
            <div id="login-result" class="result"></div>
        </div>

        <!-- OAuth Tests -->
        <div class="test-section">
            <h2>3. 🌐 OAuth Authentication Tests</h2>
            <p>Test Google and GitHub OAuth integration</p>
            <button onclick="testOAuth('google')">🔴 Test Google OAuth</button>
            <button onclick="testOAuth('github')">⚫ Test GitHub OAuth</button>
            <div id="oauth-result" class="result"></div>
        </div>

        <!-- Dashboard Access Test -->
        <div class="test-section">
            <h2>4. 🏠 Dashboard Direct Access Test</h2>
            <p>Test dashboard accessibility and authentication protection</p>
            <button onclick="testDashboardAccess()" class="dashboard-test">🏠 Open Dashboard in New Tab</button>
            <div id="dashboard-result" class="result"></div>
        </div>

        <!-- Complete Flow Test -->
        <div class="test-section">
            <h2>5. 🔄 Complete Authentication Flow Test</h2>
            <p>Test the entire user journey: Signup → Dashboard → Logout → Login → Dashboard</p>
            <button onclick="testCompleteFlow()">🎯 Run Complete Flow Test</button>
            <div id="complete-result" class="result"></div>
        </div>
    </div>

    <script>
        const FRONTEND_URL = 'https://projectconnect.tech';
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0,
            details: []
        };

        // Generate unique email for testing
        function generateTestEmail() {
            return `livetest${Date.now()}@example.com`;
        }

        function updateStatus(message) {
            document.getElementById('overall-status').innerHTML = `<span class="info">${message}</span>`;
        }

        function updateSummary() {
            document.getElementById('results-summary').innerHTML = 
                `${testResults.passed}/${testResults.total} tests passed (${testResults.failed} failed)`;
        }

        function addResult(test, success, message) {
            testResults.total++;
            if (success) {
                testResults.passed++;
            } else {
                testResults.failed++;
            }
            testResults.details.push({test, success, message});
            updateSummary();
        }

        async function testRegistration() {
            const result = document.getElementById('registration-result');
            const name = document.getElementById('reg-name').value;
            const email = document.getElementById('reg-email').value || generateTestEmail();
            const password = document.getElementById('reg-password').value;
            
            // Update email fields
            document.getElementById('reg-email').value = email;
            document.getElementById('login-email').value = email;
            
            updateStatus('Testing registration...');
            result.innerHTML = '<span class="info">🔄 Testing signup process...</span>';
            
            try {
                // Open signup page in new window
                const signupWindow = window.open(`${FRONTEND_URL}/signup`, 'signupTest', 
                    'width=800,height=600,scrollbars=yes,resizable=yes');
                
                result.innerHTML = `
<span class="info">📱 Signup page opened in new window</span>
<span class="warning">⚠️ MANUAL TEST REQUIRED:</span>
1. Fill the form with:
   - Name: ${name}
   - Email: ${email}
   - Password: ${password}
2. Click "Create Account"
3. Check if it redirects to dashboard
4. Close the window when done

<span class="success">✅ If redirected to dashboard → SUCCESS</span>
<span class="error">❌ If error/no redirect → FAILED</span>`;

                addResult('Registration', true, 'Manual test initiated');
                
                // Check if window was opened successfully
                if (signupWindow) {
                    setTimeout(() => {
                        if (!signupWindow.closed) {
                            result.innerHTML += `\n<span class="info">🔍 Window is still open - waiting for user to complete test...</span>`;
                        }
                    }, 5000);
                } else {
                    result.innerHTML = '<span class="error">❌ Failed to open signup window - popup blocked?</span>';
                    addResult('Registration', false, 'Popup blocked');
                }
                
            } catch (error) {
                result.innerHTML = `<span class="error">❌ Registration test error: ${error.message}</span>`;
                addResult('Registration', false, error.message);
            }
        }

        async function testLogin() {
            const result = document.getElementById('login-result');
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            updateStatus('Testing login...');
            result.innerHTML = '<span class="info">🔄 Testing login process...</span>';
            
            try {
                // Open login page in new window
                const loginWindow = window.open(`${FRONTEND_URL}/login`, 'loginTest', 
                    'width=800,height=600,scrollbars=yes,resizable=yes');
                
                result.innerHTML = `
<span class="info">📱 Login page opened in new window</span>
<span class="warning">⚠️ MANUAL TEST REQUIRED:</span>
1. Fill the form with:
   - Email: ${email}
   - Password: ${password}
2. Click "Sign In"
3. Check if it redirects to dashboard
4. Close the window when done

<span class="success">✅ If redirected to dashboard → SUCCESS</span>
<span class="error">❌ If error/no redirect → FAILED</span>`;

                addResult('Login', true, 'Manual test initiated');
                
            } catch (error) {
                result.innerHTML = `<span class="error">❌ Login test error: ${error.message}</span>`;
                addResult('Login', false, error.message);
            }
        }

        async function testOAuth(provider) {
            const result = document.getElementById('oauth-result');
            updateStatus(`Testing ${provider} OAuth...`);
            
            try {
                const oauthWindow = window.open(`${FRONTEND_URL}/signup`, 'oauthTest', 
                    'width=800,height=600,scrollbars=yes,resizable=yes');
                
                result.innerHTML = `
<span class="info">📱 Signup page opened for ${provider} OAuth test</span>
<span class="warning">⚠️ MANUAL TEST REQUIRED:</span>
1. Click "Continue with ${provider.charAt(0).toUpperCase() + provider.slice(1)}" button
2. Check the response:
   - Does it show a helpful message?
   - Or does it attempt OAuth flow?
3. Close the window when done

<span class="success">✅ Expected: Helpful message about OAuth not being fully configured</span>`;

                addResult(`${provider} OAuth`, true, 'Manual test initiated');
                
            } catch (error) {
                result.innerHTML = `<span class="error">❌ ${provider} OAuth test error: ${error.message}</span>`;
                addResult(`${provider} OAuth`, false, error.message);
            }
        }

        async function testDashboardAccess() {
            const result = document.getElementById('dashboard-result');
            updateStatus('Testing dashboard access...');
            
            try {
                const dashboardWindow = window.open(`${FRONTEND_URL}/dashboard`, 'dashboardTest', 
                    'width=1000,height=700,scrollbars=yes,resizable=yes');
                
                result.innerHTML = `
<span class="info">📱 Dashboard opened in new window</span>
<span class="warning">⚠️ MANUAL TEST REQUIRED:</span>
1. Check what happens:
   - If not logged in: Should redirect to login page
   - If logged in: Should show dashboard content
2. Close the window when done

<span class="success">✅ Expected: Proper authentication protection</span>`;

                addResult('Dashboard Access', true, 'Manual test initiated');
                
            } catch (error) {
                result.innerHTML = `<span class="error">❌ Dashboard test error: ${error.message}</span>`;
                addResult('Dashboard Access', false, error.message);
            }
        }

        async function testCompleteFlow() {
            const result = document.getElementById('complete-result');
            updateStatus('Running complete flow test...');
            
            result.innerHTML = `
<span class="info">🔄 Complete Authentication Flow Test</span>
<span class="warning">⚠️ MANUAL COMPREHENSIVE TEST:</span>

<strong>Phase 1: Fresh User Signup</strong>
1. Open: ${FRONTEND_URL}/signup
2. Create account with unique email
3. ✅ Verify: Redirects to dashboard after signup

<strong>Phase 2: Dashboard Access</strong>
4. ✅ Verify: Dashboard loads properly
5. ✅ Verify: User info is displayed

<strong>Phase 3: Logout</strong>
6. Click logout (if available)
7. ✅ Verify: Returns to home/login page

<strong>Phase 4: Login</strong>
8. Go to login page
9. Use same credentials from signup
10. ✅ Verify: Successfully logs in
11. ✅ Verify: Redirects to dashboard

<strong>Phase 5: OAuth Test</strong>
12. Test both Google and GitHub buttons
13. ✅ Verify: Show helpful messages

<span class="success">🎯 SUCCESS CRITERIA:</span>
- Signup works and redirects to dashboard
- Login works and redirects to dashboard  
- Dashboard is protected when not logged in
- OAuth buttons show helpful messages
- No error messages or crashes

<button onclick="openCompleteTestSuite()" style="margin-top: 15px;">🚀 Open Complete Test Suite</button>`;

            addResult('Complete Flow', true, 'Comprehensive manual test initiated');
        }

        function openCompleteTestSuite() {
            // Open multiple windows for comprehensive testing
            const windows = [
                window.open(`${FRONTEND_URL}`, 'homeTest', 'width=400,height=600,left=0,top=0'),
                window.open(`${FRONTEND_URL}/signup`, 'signupTest', 'width=400,height=600,left=420,top=0'),
                window.open(`${FRONTEND_URL}/login`, 'loginTest', 'width=400,height=600,left=840,top=0'),
                window.open(`${FRONTEND_URL}/dashboard`, 'dashboardTest', 'width=400,height=600,left=1260,top=0')
            ];
            
            updateStatus('Complete test suite opened - 4 windows for comprehensive testing');
        }

        // Initialize
        updateStatus('Ready to test authentication system');
        updateSummary();
        
        // Auto-generate email on page load
        document.getElementById('reg-email').value = generateTestEmail();
    </script>
</body>
</html>
